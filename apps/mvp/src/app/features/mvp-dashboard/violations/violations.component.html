<mat-card>
    <h3 class="text-uppercase" [marginBottom]="0">
        Violations
        <mat-icon class="material-icons grayblue-color">notifications</mat-icon>
    </h3>
    <!-- License Suspensions -->
    <section class="licenseSus" fxLayout="row wrap" fxLayoutAlign="start start">
        <ng-container *ngFor="let item of licenseArr | keyvalue">
            <ng-container *ngFor="let it of item.value | keyvalue">
                <div *ngIf="it.key === 'LicenseSuspension'" fxFlex="33" class="text-center rightborder">
                    <h3 [marginBottom]="10" translate>{{enTable}}.{{it.key}}</h3>
                    <h4 [marginTop]="0" [marginBottom]="0">Category:
                        <span [ngClass]="{'color-blue': it.value.Category ==='TEMPORARY'}">{{it.value.Category}}</span>
                    </h4>
                    <h2
                    [ngClass]="{
                        'color-lime': item.value.OperatorName.toLowerCase() === 'lime',
                        'color-bird': item.value.OperatorName.toLowerCase() === 'bird',
                        'color-casual': item.value.OperatorName.toLowerCase() === 'hopr'
                    }">{{item.value.OperatorName}}</h2>
                    <p>{{it.value.DaysLeft}} of {{it.value.TotalDays}} left</p>
                    <span class="botborder"
                    [ngClass]="{
                        'bg-lime': item.value.OperatorName.toLowerCase() === 'lime',
                        'bg-bird': item.value.OperatorName.toLowerCase() === 'bird',
                        'bg-casual': item.value.OperatorName.toLowerCase() === 'hopr'
                    }"></span>
                </div>
            </ng-container>
        </ng-container>
    </section>
    <!-- ./License Suspensions -->
    <!-- Policy -->
    <section class="policyWrap text-center" fxLayout="row wrap" fxLayoutAlign="start center" [marginTop]="10">
        <ng-container *ngFor="let item of policyArr | keyvalue; first as isFirst">
            <ng-container *ngFor="let it of item.value | keyvalue">
                <ng-container *ngFor="let p of it.value.data">
                    <h2 fxFlex *ngIf="isFirst">
                        <span class="clrcode" [ngClass]="{
                                'bg-lime': p.name === 'Policy1',
                                'bg-bird': p.name === 'Policy2',
                                'bg-members': p.name === 'Policy3',
                                'bg-casual': p.name === 'Policy4'
                            }"
                        ></span>
                        {{p.name}}
                    </h2>
                </ng-container>
                <span *ngIf="isFirst" fxFlex="100"><!--For Line Break--></span>
                <section fxFlex>
                    <workspace-policypie
                        *ngIf="it.value.data"
                        [limePolicyPieRes]="it.value.data"
                    ></workspace-policypie>
                    <h2 class="policyhead">{{it.value.name}}</h2>
                    <button mat-button mat-raised-button color="primary" class="btn-blueoutline">LIASON DETAILS</button>
                </section>
            </ng-container>
        </ng-container>
    </section>
    <!-- ./Policy -->
    <!-- Generate Button -->
    <div fxLayout="row" fxLayoutAlign="end start">
        <button 
            mat-raised-button 
            mat-button 
            color="primary" 
            [marginTop]="25"
            class="btn-green"
        >Generate Escalation Report</button>
    </div>
    <!-- ./Generate Button -->
    <!-- PolicyViolations -->
    <section fxLayout="row wrap" fxLayoutAlign="start start" [marginTop]="25">
        <table mat-table [dataSource]="violationDataSource" class="mat-elevation-z8 violationGrid" fxFlex="100">

            <!-- Column -->
            <ng-container
                [matColumnDef]="column"
                *ngFor="let column of displayedColumns; index as i; first as isFirst">
                <th mat-header-cell *matHeaderCellDef
                class="text-center">
                    <span translate>{{enTable}}.{{ column }}</span>
                </th>
                <td mat-cell *matCellDef="let element">
                    <span *ngIf="column === 'WhatHappened'; else regularCol">
                        {{ element[column].Subject }}
                        <button 
                            *ngIf="element[column].IsEscalated" 
                            mat-button mat-raised-button 
                            color="primary"
                            class="fl-r"
                            [marginTop]="5"
                            [marginBottom]="5"
                            >Escalate
                        </button>
                    </span>
                    <ng-template #regularCol>
                        <span *ngIf="column === 'STATUS'; else nonStatus">
                            <span *ngIf="element[column] === 'ACTIVE'" class="color-bird">{{element[column]}}</span>
                            <span *ngIf="element[column] === 'DONE'" class="bg-green done">{{element[column]}}</span>
                        </span>
                        <ng-template #nonStatus>
                            {{ element[column]}}
                        </ng-template>
                    </ng-template>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
    </section>
    <!-- ./PolicyViolations -->
</mat-card>