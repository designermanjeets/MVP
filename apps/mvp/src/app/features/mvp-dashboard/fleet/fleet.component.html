<mat-card>
    <h3 class="text-uppercase" [marginBottom]="0">
        Fleet
        <mat-icon class="material-icons grayblue-color">notifications</mat-icon>
    </h3>
    <span class="font14">Last updated 5 min ago</span>
    <!-- Fleet -->
    <section fxLayout="row" fxLayoutAlign="start start" class="fleetmode">
        <section fxFlex *ngFor="let item of fleetInsightsArr">
            <ng-container *ngFor="let op of item | keyvalue">
                <h2 class="grayblue-color" [marginBottom]="0">{{op.value.TotalVehicles.count}}
                    <span 
                        [ngClass]="op.key ==='LIME' ? 'color-green': op.key ==='HOPR MEMBERS' ? 'color-blue': 'color-seablue'">
                        ({{op.value.TotalVehicles.capped}})
                    </span>
                </h2>
                <h4 [marginTop]="5" class="grayblue-color">{{op.key}}</h4>
                <p [marginBottom]="4">{{op.value.TotalVehicles.available}} are available</p>
                <p [marginTop]="0">{{op.value.TotalVehicles.outOfService}} are out of service</p>
                <span class="botborder" [ngClass]="op.key ==='LIME' ? 'bg-green': op.key ==='HOPR MEMBERS' ? 'bg-blue': 'bg-seablue'"></span>
            </ng-container>
        </section>
    </section>
    <!-- ./Fleet -->
    <section class="puposePieChart" fxLayout="row" fxLayoutAlign="start start">
        <section fxFlex="40">
            <!-- Modes -->
            <h3 class="text-uppercase pos-rel zIndex">Modes</h3>
            <div class="modepiewrap">
                <workspace-modespie *ngIf="commutePieResult" [commutePieResult]="commutePieResult"></workspace-modespie>
            </div>
        </section>
        <!-- ./ Modes-->
        <!-- Utilization -->
        <section fxFlex="60" class="utili">
            <h3 class="text-uppercase">Utilization</h3>
            <workspace-tripchart *ngIf="chartData" [chartData]="chartData"></workspace-tripchart>
        </section>
        <!-- ./Utilization -->
    </section>
    <!-- Fleet Grid -->
    <section class="fleetGrid" fxLayout="row" [marginTop]="25" fxLayoutAlign="start start">
        <table mat-table [dataSource]="displayData" matSort class="mat-elevation-z8 text-center tripGrid" fxFlex="100">
            <ng-container 
                [matColumnDef]="column" 
                *ngFor="let column of displayColumns; index as i; first as isFirst">
                <th mat-header-cell *matHeaderCellDef
                [attr.rowspan]="column !== 'hopr members' && column !== 'hopr casual' ? 2 : 1"
                [ngClass]="{'splitCol': column === 'hopr members' || column === 'hopr casual', 'zeroCol': column === '0'}"
                class="text-center">
                    <mat-icon 
                        *ngIf="column !== '0'"
                        [ngClass]="{
                            'color-lime': column === 'lime',
                            'color-bird': column === 'bird',
                            'color-members': column === 'hopr members',
                            'color-casual': column === 'hopr casual'
                        }"
                        class="material-icons">
                        fiber_manual_record
                    </mat-icon>
                    {{ column }}
                </th>
                <td mat-cell *matCellDef="let element">
                    <span *ngIf="isFirst; else nontranslate" translate class="text-uppercase"> {{enTable}}.{{ element[column] }}</span>
                    <ng-template #nontranslate>{{ element[column] }}</ng-template>
                </td>
            </ng-container>
            <!-- HOPR Column -->
            <ng-container matColumnDef="hopr">
                <th mat-header-cell *matHeaderCellDef colspan="2" class="colhopr"> HOPR </th>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayColumns"></tr>
            <tr mat-header-row *matHeaderRowDef="['hopr']"></tr>
            <tr mat-row *matRowDef="let row; columns: displayColumns;"></tr>
        </table>
    </section>
    <!-- ./Fleet Grid -->

    <section [marginTop]="35"  class="densityGrid" fxLayout="row" fxLayoutAlign="start start" fxLayoutGap="20px">
        <!-- GRID -->
        <table mat-table [dataSource]="desnityDataSource" class="mat-elevation-z8" fxFlex>
          
            <!-- Column -->
            <ng-container matColumnDef="trip">
              <th mat-header-cell *matHeaderCellDef rowspan="2"><!----></th>
              <td mat-cell *matCellDef="let element"> {{element.trip}} </td>
            </ng-container>
          
            <!-- Column -->
            <ng-container matColumnDef="Vehicledensity">
              <th mat-header-cell *matHeaderCellDef class="text-center"> Vehicle density </th>
              <td mat-cell *matCellDef="let element">
                  <div fxLayout="row-reverse" fxLayoutAlign="space-around start">
                    <span *ngFor="let item of element.Vehicledensity | keyvalue">
                        {{item.value}}
                    </span>
                  </div>
              </td>
            </ng-container>
          
            <!-- Column -->
            <ng-container matColumnDef="VehicleActivity">
              <th mat-header-cell *matHeaderCellDef class="text-center"> Vehicle Activity </th>
              <td mat-cell *matCellDef="let element">
                <div fxLayout="row-reverse" fxLayoutAlign="space-around start">
                    <span *ngFor="let item of element.VehicleActivity | keyvalue">
                        {{item.value}}
                    </span>
                  </div>
              </td>
            </ng-container>
            
            <ng-container matColumnDef="denminmax">
                <th mat-header-cell *matHeaderCellDef> 
                    <div fxLayout="row-reverse" fxLayoutAlign="space-around start">
                        <span>MAX</span>
                        <span>MIN</span>
                    </div>
                </th>
            </ng-container>
            
            <ng-container matColumnDef="actminmax">
                <th mat-header-cell *matHeaderCellDef> 
                    <div fxLayout="row-reverse" fxLayoutAlign="space-around start">
                        <span>MAX</span>
                        <span>MIN</span>
                    </div>
                </th>
            </ng-container>
          
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            <tr mat-header-row *matHeaderRowDef="['denminmax', 'actminmax']"></tr>
          </table>
          <!-- ./GRID -->
          <!-- Maintenance -->
          <section fxFlex="200px">
            <h3 class="text-uppercase" [marginTop]="0" [marginBottom]="35" class="font17">Maintenance Cadence</h3>
            <div fxLayout="row wrap" fxLayoutAlign="center start" class="text-center">
                <div fxFlex="50">
                    <div class="calwrap">
                        <mat-form-field class="calWithNoInput">
                            <input matInput [matDatepicker]="picker1" >
                            <mat-datepicker #picker1></mat-datepicker>
                        </mat-form-field>

                        <button mat-fab color="primary" (click)="picker1.open()">
                            <mat-icon>date_range</mat-icon>
                        </button>
                    </div>
                </div>
                <div fxFlex="50">
                    <div class="calwrap">
                        <mat-form-field class="calWithNoInput">
                            <input matInput [matDatepicker]="picker2" >
                            <mat-datepicker #picker2></mat-datepicker>
                        </mat-form-field>

                        <button mat-fab color="accent" (click)="picker2.open()">
                            <mat-icon>date_range</mat-icon>
                        </button>
                    </div>
                </div>
                <div fxFlex="50">
                    <div class="calwrap">
                        <mat-form-field class="calWithNoInput">
                            <input matInput [matDatepicker]="picker3" >
                            <mat-datepicker #picker3></mat-datepicker>
                        </mat-form-field>

                        <button mat-fab color="warn" (click)="picker3.open()">
                            <mat-icon>date_range</mat-icon>
                        </button>
                    </div>
                </div>
                <div fxFlex="50">
                    <div class="calwrap">
                        <mat-form-field class="calWithNoInput">
                            <input matInput [matDatepicker]="picker4" >
                            <mat-datepicker #picker4></mat-datepicker>
                        </mat-form-field>

                        <button mat-fab color="primary" (click)="picker4.open()">
                            <mat-icon>date_range</mat-icon>
                        </button>
                    </div>
                </div>
            </div>
          </section>
          <!-- ./Maintenance -->
    </section>
</mat-card>
